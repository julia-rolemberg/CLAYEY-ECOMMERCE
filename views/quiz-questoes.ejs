<script type="text/javascript">
let temp = document.getElementById("produtos").value;
const lista = JSON.parse(temp);

const questoes = [
    {
        id: 1,
        titulo: "Qual seu tipo de pele?",
        alternativas: [
            {
                "texto": "Normal"
            },
            {
                "texto": "Seca"
            },
            {
                "texto": "Oleosa"
            },
            {
                "texto": "Mista"
            },
            {
                "texto": "Acneica"
            },
            {
                "texto": "Madura"
            }
        ]
    },
    {
        id: 2,
        titulo: "O seu sabonete ideal deve ter função de:",
        alternativas: [
            {
                "texto": "Hidratação profunda"
            },
            {
                "texto": "Limpeza profunda"
            },
            {
                "texto": "Esfoliação leve"
            },
            {
                "texto": "Esfoliação média"
            }
        ]
    },
    {
        id: 3,
        titulo: "Em óleos essenciais, além da fragrância, qual propriedade você valoriza?",
        alternativas: [
            {
                "texto": "Equilíbrio emocional"
            },
            {
                "texto": "Relaxamento"
            },
            {
                "texto": "Estimulante"
            }
        ]
    },
    {
        id: 4,
        titulo: "Na hora do banho, você gosta de:",
        alternativas: [
            {
                "texto": "Muita espumação "
            },
            {
                "texto": "Espumação leve"
            }
        ]
    },
    {
        id: 5,
        titulo: "O seu sabonete ideal é:",
        alternativas: [
            {
                "texto": "100% natural"
            },
            {
                "texto": "100% natural e vegano"
            }
        ]
    }
]

    const normal = questoes[0].alternativas[0].texto;
    const seca = questoes[0].alternativas[1].texto;
    const oleosa = questoes[0].alternativas[2].texto;
    const mista = questoes[0].alternativas[3].texto;
    const acneica = questoes[0].alternativas[4].texto;
    const madura = questoes[0].alternativas[5].texto;

    const hidratacao = questoes[1].alternativas[0].texto;
    const limpeza = questoes[1].alternativas[1].texto;
    const esfoleve = questoes[1].alternativas[2].texto;
    const esfomedia = questoes[1].alternativas[3].texto;

    const equilibrio = questoes[2].alternativas[0].texto;
    const relaxamento = questoes[2].alternativas[1].texto;
    const estimulante = questoes[2].alternativas[2].texto;

    const espualta = questoes[3].alternativas[0].texto;
    const espuleve = questoes[3].alternativas[1].texto;

    const natural = questoes[4].alternativas[0].texto;
    const vegano = questoes[4].alternativas[1].texto;


    //RESULTADOS
    const resultados = [
    //id_produto  -  [alternativa1, alternativa2, alternativa3...]  
        {id: "1", path: [normal, hidratacao, relaxamento, espuleve]}, 
        {id: "1", path: [seca, hidratacao, relaxamento, espuleve]},
        {id: "1", path: [oleosa, hidratacao, relaxamento, espuleve]},
        {id: "1", path: [mista, hidratacao, relaxamento, espuleve]},
        {id: "1", path: [acneica, hidratacao, relaxamento, espuleve]},
        {id: "1", path: [madura, hidratacao, relaxamento, espuleve]},

        {id: "2", path: [oleosa, esfoleve, relaxamento, espuleve]},
        {id: "2", path: [acneica, esfoleve, relaxamento, espuleve]},

        {id: "3", path: [normal, hidratacao, relaxamento, espualta]}, 
        {id: "3", path: [seca, hidratacao, relaxamento, espualta]}, 
        {id: "3", path: [oleosa, hidratacao, relaxamento, espualta]}, 
        {id: "3", path: [mista, hidratacao, relaxamento, espualta]}, 
        {id: "3", path: [acneica, hidratacao, relaxamento, espualta]}, 
        {id: "3", path: [madura, hidratacao, relaxamento, espualta]}, 

        {id: "4", path: [mista, hidratacao, estimulante, espuleve]},

        {id: "5", path: [seca, hidratacao, estimulante, espualta]},

        {id: "6", path: [madura, esfoleve, equilibrio, espualta]},
        {id: "6", path: [madura, esfoleve, relaxamento, espualta]},

        {id: "7", path: [oleosa, esfomedia, equilibrio, espuleve]},
        {id: "7", path: [oleosa, esfomedia, relaxamento, espuleve]},
        
        {id: "8", path: [madura, hidratacao, equilibrio, espualta]}, 
        {id: "8", path: [madura, hidratacao, relaxamento, espualta]}, 

    ]

function comparaResultado() {
    let id,
       maior = 0;
   resultados.forEach((objeto)=>{
      let conta = 0;
      escolhas.forEach(escolha =>{
         if(objeto.path.includes(escolha)) conta++;
      });

      if(conta == 6)
        return id;

      if(conta > maior){
         id = objeto.id;
         maior = conta;
      }
    });

    if(maior >= 2){
        return id
    }

    return false
}
   
function obterResultado(){
    //comparar o array do usuário com os resultados possíveis
    const id = comparaResultado();
    let produto

    if(id !== false){
        for(let i in lista){
            if(lista[i].id == id){
                produto = lista[i]
                break;
            }
        }
    } else {
        produto = false;
    }
    
    mostrarResultado(produto);
}
</script>